"use strict";(self.webpackChunk_6_r_1_h_24=self.webpackChunk_6_r_1_h_24||[]).push([[7491],{6690:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var r=t(5893),s=t(1151);const i={slug:"/notes/perso_win/wim/sysprep",sidebar_position:3,title:"Sysprep"},o="Sysprep",a={id:"notes/perso_windows/wim/sysprep",title:"Sysprep",description:"Sysprep est un utilitaire qui permet de pr\xe9parer une installation de Windows \xe0 \xeatre captur\xe9e.",source:"@site/docs/notes/perso_windows/wim/sysprep.md",sourceDirName:"notes/perso_windows/wim",slug:"/notes/perso_win/wim/sysprep",permalink:"/h24-6r1/notes/perso_win/wim/sysprep",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{slug:"/notes/perso_win/wim/sysprep",sidebar_position:3,title:"Sysprep"},sidebar:"tutorialSidebar",previous:{title:"Modifier une image Windows",permalink:"/h24-6r1/notes/perso_win/wim/modifier_image"},next:{title:"Capturer une image Windows",permalink:"/h24-6r1/notes/perso_win/wim/capture_wim"}},c={},d=[{value:"Pr\xe9requis",id:"pr\xe9requis",level:2},{value:"Proc\xe9dure",id:"proc\xe9dure",level:2},{value:"R\xe9f\xe9rences",id:"r\xe9f\xe9rences",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"sysprep",children:"Sysprep"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Sysprep"})," est un utilitaire qui permet de pr\xe9parer une installation de ",(0,r.jsx)(n.strong,{children:"Windows"})," \xe0 \xeatre captur\xe9e."]}),"\n",(0,r.jsx)(n.p,{children:"Cet utilitaire supprime les \xe9l\xe9ments sp\xe9cifiques \xe0 l'ordinateur pour que l'image soit r\xe9int\xe9grable dans un domaine et avoir une configuration mat\xe9rielle diff\xe9rente."}),"\n",(0,r.jsxs)(n.p,{children:["La proc\xe9dure ci-dessous explique comment retirer le ",(0,r.jsx)(n.strong,{children:"oobe"})," du programme d'installation et d'ignorer l'ajout d'un nouvel administrateur local."]}),"\n",(0,r.jsx)(n.h2,{id:"pr\xe9requis",children:"Pr\xe9requis"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Avoir un acc\xe8s administrateur de ",(0,r.jsx)(n.strong,{children:"Windows"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"proc\xe9dure",children:"Proc\xe9dure"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Cr\xe9ez le fichier ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"%windir%\\system32\\sysprep\\unattended.xml"})})," avec le contenu ci-dessous."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="utf-8"?>\r\n<unattend xmlns="urn:schemas-microsoft-com:unattend"\r\n\t\t  xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State">\r\n\t<settings pass="specialize">\r\n        <component name="Microsoft-Windows-Deployment"\r\n                processorArchitecture="amd64"\r\n                publicKeyToken="31bf3856ad364e35"\r\n                language="neutral" versionScope="nonSxS">\r\n            <RunSynchronous>\r\n\t\t\t\t<RunSynchronousCommand wcm:action="add">\r\n\t\t\t\t\t<Description>Disable create user account</Description>\r\n\t\t\t\t\t<Path>reg add HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Setup\\OOBE /v UnattendCreatedUser /t REG_DWORD /d 1 /f</Path>\r\n\t\t\t\t\t<Order>1</Order>\r\n\t\t\t\t</RunSynchronousCommand>\r\n\t\t\t</RunSynchronous>\r\n        </component>\r\n\t</settings>\r\n\t<settings pass="oobeSystem">\r\n\t\t<component name="Microsoft-Windows-International-Core" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\r\n\t\t\t<InputLocale>0c0c:00001009</InputLocale>\r\n\t\t\t<SystemLocale>fr-CA</SystemLocale>\r\n\t\t\t<UILanguage>fr-FR</UILanguage>\r\n\t\t\t<UILanguageFallback>en-us</UILanguageFallback>\r\n\t\t\t<UserLocale>fr-CA</UserLocale>\r\n\t\t</component>\r\n\t\t<component name="Microsoft-Windows-Shell-Setup" processorArchitecture="amd64" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" xmlns:wcm="http://schemas.microsoft.com/WMIConfig/2002/State" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\t\t\t\r\n\t\t\t<OOBE>\r\n\t\t\t\t<HideEULAPage>true</HideEULAPage>\t\t\t\t\r\n\t\t\t\t<HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>\r\n\t\t\t\t<HideOnlineAccountScreens>true</HideOnlineAccountScreens>\r\n\t\t\t\t<ProtectYourPC>1</ProtectYourPC>\r\n\t\t\t\t<HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>\r\n\t\t\t\t<NetworkLocation>Work</NetworkLocation>\r\n\t\t\t</OOBE>\r\n\t\t\t<TimeZone>Eastern Standard Time</TimeZone>\r\n\t\t</component>\r\n\t</settings>\t\r\n</unattend>\n'})}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsxs)(n.p,{children:["Ce fichier permet d'automatiser certaines parties de l'installation de ",(0,r.jsx)(n.strong,{children:"Windows"}),". Le fichier pr\xe9sent\xe9 correspond au besoin du cours."]}),(0,r.jsxs)(n.p,{children:["Pour plus d'information sur les possibilit\xe9s de ce fichier : ",(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/windows-hardware/customize/desktop/unattend/",children:"https://learn.microsoft.com/fr-ca/windows-hardware/customize/desktop/unattend/"})]})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Ouvrez l'",(0,r.jsx)(n.strong,{children:"invite de commandes"})," en tant qu'administrateur."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["D\xe9placez vous dans le dossier ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"%windir%\\system32\\sysprep"})}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Effectuez la commande ci-dessous."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"sysprep /generalize /oobe /shutdown /unattend:unattended.xml\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"r\xe9f\xe9rences",children:"R\xe9f\xe9rences"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11",children:"https://learn.microsoft.com/fr-ca/windows-hardware/manufacture/desktop/sysprep--generalize--a-windows-installation?view=windows-11"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://learn.microsoft.com/fr-ca/windows-hardware/customize/desktop/unattend/microsoft-windows-shell-setup-oobe",children:"https://learn.microsoft.com/fr-ca/windows-hardware/customize/desktop/unattend/microsoft-windows-shell-setup-oobe"})})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var r=t(7294);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);